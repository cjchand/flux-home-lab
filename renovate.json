{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:recommended"
  ],
  "helm-values": {
    "enabled": true
  },
  "packageRules": [
    {
      "matchManagers": [
        "helmfile",
        "helm-values"
      ],
      "matchFileNames": [
        "clusters/dev/apps/**/helmrelease.yaml"
      ],
      "groupName": "HelmRelease updates"
    },
    {
      "matchManagers": [
        "custom.regex"
      ],
      "matchFileNames": [
        "clusters/dev/apps/**/helmrelease.yaml"
      ],
      "groupName": "App image tag updates",
      "customManagers": [
        {
          "customType": "regex",
          "managerFilePatterns": [
            "/clusters/dev/apps/.*/helmrelease.yaml$/"
          ],
          "matchStrings": [
            "repository:\\s*['\"]?(?<depName>[^'\"\\s]+)['\"]?\\s*\\ntag:\\s*['\"]?(?<currentValue>[\\w\\.-]+)['\"]?"
          ],
          "datasourceTemplate": "docker"
        }
      ]
    }
  ]
}
